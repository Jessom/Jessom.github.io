<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>わタしの ブログ</title>
  <subtitle>watasi的博客</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://watasi.cn/"/>
  <updated>2017-08-01T00:52:17.451Z</updated>
  <id>http://watasi.cn/</id>
  
  <author>
    <name>わタし</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>基于MUI开发的一套模板</title>
    <link href="http://watasi.cn/2017/08/01/%E5%9F%BA%E4%BA%8EMUI%E5%BC%80%E5%8F%91%E7%9A%84%E4%B8%80%E5%A5%97%E6%A8%A1%E6%9D%BF/"/>
    <id>http://watasi.cn/2017/08/01/基于MUI开发的一套模板/</id>
    <published>2017-08-01T00:28:18.781Z</published>
    <updated>2017-08-01T00:52:17.451Z</updated>
    
    <content type="html"><![CDATA[<h2 id="项目介绍"><a href="#项目介绍" class="headerlink" title="项目介绍"></a>项目介绍</h2><p>公司准备用MUI框架，开发一套模板，方便于未来进行二次、三次开发。本人本着绝对服从领导指示的原则，参与了模板的开发，这里把项目开源一下。<br>该项目目前功能不是很完善(至少提交App Store被批为<code>无用的爱啪啪</code>)，后续会添加更多的功能。<br><a href="https://github.com/Jessom/MUI" target="_blank" rel="external">戳这里</a>查看项目源码。</p>
<h2 id="目录结构"><a href="#目录结构" class="headerlink" title="目录结构"></a>目录结构</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line">|-default                 页面资源</div><div class="line">  |-css                   样式表</div><div class="line">    |-css                 sass编译后的css</div><div class="line">    |-sass                sass源码</div><div class="line">  |-iconfont              字体图标</div><div class="line">  |-images                图片资源</div><div class="line">  |-js                    页面js文件</div><div class="line">|-Public                  公共资源</div><div class="line">  |-css                   公共css</div><div class="line">  |-images                公共图片资源</div><div class="line">  |-js                    公共js文件</div><div class="line">  |-plugins               插件</div><div class="line">|-.project                HBuilder编辑器生成文件</div><div class="line">|-manifest.json           app配置文件</div><div class="line">|-abotut.html             关于我们</div><div class="line">|-detail.html             详情</div><div class="line">|-editor.html             编辑</div><div class="line">|-forget_password.html    找回密码</div><div class="line">|-home.html               主页</div><div class="line">|-index.html              入口</div><div class="line">|-login.html              登录</div><div class="line">|-personal.html           个人</div><div class="line">|-preview.html            预览</div><div class="line">|-publish.html            发布选项</div><div class="line">|-reg.html                注册</div><div class="line">|-release.html            发布</div><div class="line">|-setting.html            设置</div><div class="line">|-userinfo.html           个人信息</div></pre></td></tr></table></figure>
<h2 id="技术栈"><a href="#技术栈" class="headerlink" title="技术栈"></a>技术栈</h2><ol>
<li>主要用到的就是MUI</li>
<li>数据渲染的部分使用了vue1.0.28</li>
</ol>
<h2 id="功能"><a href="#功能" class="headerlink" title="功能"></a>功能</h2><p>[x] 注册<br>[x] 登录<br>[x] 发布文章<br>[x] 浏览文章</p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;项目介绍&quot;&gt;&lt;a href=&quot;#项目介绍&quot; class=&quot;headerlink&quot; title=&quot;项目介绍&quot;&gt;&lt;/a&gt;项目介绍&lt;/h2&gt;&lt;p&gt;公司准备用MUI框架，开发一套模板，方便于未来进行二次、三次开发。本人本着绝对服从领导指示的原则，参与了模板的开发，这里把项
    
    </summary>
    
      <category term="mui" scheme="http://watasi.cn/categories/mui/"/>
    
    
  </entry>
  
  <entry>
    <title>iis7托管nodejs应用程序</title>
    <link href="http://watasi.cn/2017/07/29/iis7%E6%89%98%E7%AE%A1nodejs%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F/"/>
    <id>http://watasi.cn/2017/07/29/iis7托管nodejs应用程序/</id>
    <published>2017-07-29T06:36:22.229Z</published>
    <updated>2017-07-31T00:43:13.541Z</updated>
    
    <content type="html"><![CDATA[<h1 id="1-参考资料"><a href="#1-参考资料" class="headerlink" title="1. 参考资料"></a>1. 参考资料</h1><p><a href="http://www.jb51.net/article/61569.htm" target="_blank" rel="external">http://www.jb51.net/article/61569.htm</a><br><a href="http://www.cnblogs.com/chenweixuan/p/5489343.html" target="_blank" rel="external">http://www.cnblogs.com/chenweixuan/p/5489343.html</a></p>
<h1 id="2-开始"><a href="#2-开始" class="headerlink" title="2. 开始"></a>2. 开始</h1><p><a href="https://nodejs.org/en/download/" target="_blank" rel="external">NodeJs</a><br><a href="https://www.iis.net/downloads/microsoft/url-rewrite" target="_blank" rel="external">URL Rewrite</a><br><a href="https://github.com/tjanczuk/iisnode" target="_blank" rel="external">iisnode</a><br><a href="https://github.com/azure/iisnode/releases/download/v0.2.21/iisnode-full-v0.2.21-x86.msi" target="_blank" rel="external">iisnode x86下载</a><br><a href="https://github.com/azure/iisnode/releases/download/v0.2.21/iisnode-full-v0.2.21-x64.msi" target="_blank" rel="external">iisnode x64下载</a></p>
<p>安装完成后，在IIS中创建站点，指向nodejs应用程序目录(这里以express项目为例)，<code>在nodejs应用程序中添加web.config文件</code>：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">&lt;configuration&gt;</div><div class="line">    &lt;system.webServer&gt;</div><div class="line">        &lt;handlers&gt;</div><div class="line">            &lt;add name=&quot;iisnode&quot; path=&quot;start.js&quot; verb=&quot;*&quot; modules=&quot;iisnode&quot; resourceType=&quot;Unspecified&quot; requireAccess=&quot;Script&quot; /&gt;</div><div class="line">        &lt;/handlers&gt;</div><div class="line">        &lt;rewrite&gt;</div><div class="line">            &lt;rules&gt;</div><div class="line">                &lt;rule name=&quot;all&quot;&gt;</div><div class="line">                    &lt;match url=&quot;/*&quot; /&gt;</div><div class="line">                    &lt;action type=&quot;Rewrite&quot; url=&quot;start.js&quot; /&gt;</div><div class="line">                &lt;/rule&gt;</div><div class="line">            &lt;/rules&gt;</div><div class="line">        &lt;/rewrite&gt;</div><div class="line">    &lt;/system.webServer&gt;</div><div class="line">&lt;/configuration&gt;</div></pre></td></tr></table></figure>
<p><strong>注意：</strong> <add name="iisnode" `path="start.js" `="" verb="*" modules="iisnode" resourcetype="Unspecified" requireaccess="Script">及<action type="Rewrite" `url="start.js" `=""></action></add></p>
<p>start.js文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">#!/usr/bin/env node</div><div class="line">require(&apos;./bin/www&apos;);</div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;1-参考资料&quot;&gt;&lt;a href=&quot;#1-参考资料&quot; class=&quot;headerlink&quot; title=&quot;1. 参考资料&quot;&gt;&lt;/a&gt;1. 参考资料&lt;/h1&gt;&lt;p&gt;&lt;a href=&quot;http://www.jb51.net/article/61569.htm&quot; targ
    
    </summary>
    
    
      <category term="nodejs" scheme="http://watasi.cn/tags/nodejs/"/>
    
      <category term="iis" scheme="http://watasi.cn/tags/iis/"/>
    
  </entry>
  
  <entry>
    <title>mui监测IOS版本更新</title>
    <link href="http://watasi.cn/2017/07/29/mui%E7%9B%91%E6%B5%8BIOS%E7%89%88%E6%9C%AC%E6%9B%B4%E6%96%B0/"/>
    <id>http://watasi.cn/2017/07/29/mui监测IOS版本更新/</id>
    <published>2017-07-29T05:57:23.316Z</published>
    <updated>2017-07-29T05:59:24.499Z</updated>
    
    <content type="html"><![CDATA[<p>使用<code>mui</code>开发混合app，上架app stroe后，监测app store是否有更新，并提示用户跳转app store更新应用。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> ver;    <span class="comment">// 用于保存当前应用版本</span></div><div class="line"></div><div class="line">mui.plusReady(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;         </div><div class="line">     plus.runtime.getProperty(plus.runtime.appid, <span class="function"><span class="keyword">function</span>(<span class="params">inf</span>) </span>&#123;</div><div class="line">         ver = inf.version;        <span class="comment">// 当前应用版本</span></div><div class="line">         <span class="keyword">var</span> ua = navigator.userAgent.toLowerCase();</div><div class="line">         <span class="keyword">if</span>(<span class="regexp">/iphone|ipad|ipod/</span>.test(ua)) &#123;    <span class="comment">// iphone</span></div><div class="line">             mui.ajax(&#123;</div><div class="line">                 url: <span class="string">'http://itunes.apple.com/lookup?id=1166765111'</span>,</div><div class="line">                 type: <span class="string">"GET"</span>,</div><div class="line">                 dataType: <span class="string">"json"</span>,</div><div class="line">                 data: &#123;</div><div class="line">                     id: <span class="number">1166765111</span></div><div class="line">                 &#125;,</div><div class="line">                 contentType:<span class="string">'application/x-www-form-urlencoded;charset=UTF-8'</span>,</div><div class="line">                 success: <span class="function"><span class="keyword">function</span>(<span class="params">res</span>)</span>&#123;</div><div class="line">                     <span class="comment">//console.log(JSON.stringify(res));</span></div><div class="line">                     <span class="keyword">var</span> version = res.results[<span class="number">0</span>].version;</div><div class="line">                     <span class="keyword">if</span>(version &gt; ver) &#123;</div><div class="line">                         mui.alert(res.results[<span class="number">0</span>].releaseNotes, <span class="string">"版本更新"</span>, <span class="string">"确定"</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">                             <span class="keyword">var</span> url = <span class="string">'itms-apps://itunes.apple.com/us/app/id1166765111'</span>;</div><div class="line">                             plus.runtime.openURL(url);</div><div class="line">                         &#125;)</div><div class="line">                     &#125;</div><div class="line">                 &#125;</div><div class="line">             &#125;)</div><div class="line">         &#125;</div><div class="line">    &#125;);</div><div class="line"></div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;使用&lt;code&gt;mui&lt;/code&gt;开发混合app，上架app stroe后，监测app store是否有更新，并提示用户跳转app store更新应用。&lt;br&gt;&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td clas
    
    </summary>
    
    
      <category term="mui" scheme="http://watasi.cn/tags/mui/"/>
    
  </entry>
  
  <entry>
    <title>Nodejs使用request以流的形式转发图片</title>
    <link href="http://watasi.cn/2017/07/29/Nodejs%E4%BD%BF%E7%94%A8request%E4%BB%A5%E6%B5%81%E7%9A%84%E5%BD%A2%E5%BC%8F%E8%BD%AC%E5%8F%91%E5%9B%BE%E7%89%87/"/>
    <id>http://watasi.cn/2017/07/29/Nodejs使用request以流的形式转发图片/</id>
    <published>2017-07-29T02:55:12.404Z</published>
    <updated>2017-07-29T05:51:26.283Z</updated>
    
    <content type="html"><![CDATA[<p>做项目的时候，需要用Nodejs做代理转发，服务器那边要求图片以<code>流</code>的方式上传，这里记录一下Nodejs以<code>流</code>的形式读取本地图片并上传。</p>
<h2 id="1-安装依赖"><a href="#1-安装依赖" class="headerlink" title="1. 安装依赖"></a>1. 安装依赖</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install request md5</div></pre></td></tr></table></figure>
<h2 id="2-需要模块"><a href="#2-需要模块" class="headerlink" title="2. 需要模块"></a>2. 需要模块</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">"fs"</span>);</div><div class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">"path"</span>);</div><div class="line"><span class="keyword">const</span> request = <span class="built_in">require</span>(<span class="string">"request"</span>);</div><div class="line"><span class="keyword">const</span> md5 = <span class="built_in">require</span>(<span class="string">"md5"</span>);</div></pre></td></tr></table></figure>
<h2 id="3-具体操作"><a href="#3-具体操作" class="headerlink" title="3. 具体操作"></a>3. 具体操作</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 获取前台穿过来到图片base64信息</span></div><div class="line"><span class="keyword">let</span> img = req.body.img;</div><div class="line"></div><div class="line"><span class="comment">// 去掉base64头部</span></div><div class="line"><span class="keyword">let</span> base64Data = img.replace(<span class="regexp">/^data:image\/\w+;base64,/</span>, <span class="string">""</span>);</div><div class="line"></div><div class="line"><span class="comment">// 转换成二进制</span></div><div class="line"><span class="keyword">let</span> buffer = <span class="keyword">new</span> Buffer(base64Data, <span class="string">"base64"</span>);</div><div class="line"></div><div class="line"><span class="comment">// 生成图片md5值</span></div><div class="line"><span class="keyword">let</span> md5Data = md5(buffer);</div><div class="line"></div><div class="line"><span class="comment">// 保存图片</span></div><div class="line">fs.writeFile(path.join(__dirname+<span class="string">"/../uploads"</span>, <span class="string">`<span class="subst">$&#123;md5Data&#125;</span>.jpg`</span>), buffer, (err) =&gt; &#123;</div><div class="line">	<span class="keyword">if</span>(err) &#123;</div><div class="line">		<span class="built_in">console</span>.log(err);</div><div class="line">		<span class="keyword">return</span>;</div><div class="line">   &#125;</div><div class="line"></div><div class="line">   <span class="comment">// 读取图片</span></div><div class="line">   fs.createReadStream(path.join(__dirname+<span class="string">`/../uploads/<span class="subst">$&#123;md5Data&#125;</span>.jpg`</span>)).pipe(request(&#123;</div><div class="line">		url: url,</div><div class="line">      method: <span class="string">"POST"</span>,</div><div class="line">      headers: &#123; <span class="string">"Content-Type"</span>: <span class="string">"application/json"</span> &#125;</div><div class="line">      ...</div><div class="line">   &#125;, (error, response, body) =&gt; &#123;</div><div class="line">		<span class="built_in">console</span>.log(body);</div><div class="line">   &#125;));</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;做项目的时候，需要用Nodejs做代理转发，服务器那边要求图片以&lt;code&gt;流&lt;/code&gt;的方式上传，这里记录一下Nodejs以&lt;code&gt;流&lt;/code&gt;的形式读取本地图片并上传。&lt;/p&gt;
&lt;h2 id=&quot;1-安装依赖&quot;&gt;&lt;a href=&quot;#1-安装依赖&quot; class=
    
    </summary>
    
    
      <category term="nodejs" scheme="http://watasi.cn/tags/nodejs/"/>
    
  </entry>
  
</feed>
